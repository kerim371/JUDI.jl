<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="canonical" href="https://slimgroup.github.io/JUDI.jl/helper/">
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Helper functions - JUDI</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Helper functions";
    var mkdocs_page_input_path = "helper.md";
    var mkdocs_page_url = "/JUDI.jl/helper/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> JUDI</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../tutorials/">Tutorials</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../data_structures/">Data structures</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../abstract_vectors/">Abstract vectors</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../linear_operators/">Linear operators</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../io/">Input/Output</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Helper functions</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#ricker-wavelet">Ricker wavelet</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#compute-cfl-time-stepping-interval">Compute CFL time stepping interval</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#compute-number-of-computational-time-steps">Compute number of computational time steps</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#set-up-3d-acquisition-grid">Set up 3D acquisition grid</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#data-interpolation">Data interpolation</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#generate-and-sample-from-frequency-distribution">Generate and sample from frequency distribution</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#read-data-from-out-of-core-container">Read data from out of core container</a>
    </li>
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../preconditioners/">Preconditioners</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../pysource/">Python API</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../about/">About</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">JUDI</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Helper functions</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/slimgroup/JUDI.jl/edit/master/docs/helper.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>

          <div role="main">
            <div class="section">
              
                <h1 id="helper-functions">Helper functions</h1>
<h2 id="ricker-wavelet">Ricker wavelet</h2>
<p>Create a 1D Ricker wavelet:</p>
<pre><code class="language-julia">wavelet = ricker_wavelet(tmax, dt, f0)
</code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li>
<p><code>tmax</code>: Modeling time in milliseconds <code>[ms]</code>.</p>
</li>
<li>
<p><code>dt</code>: Sampling interval in milliseconds (can be different from <code>dt</code> of shot data).</p>
</li>
<li>
<p><code>f0</code>: Peak frequency in Kilohertz <code>[kHz]</code>.</p>
</li>
</ul>
<h2 id="compute-cfl-time-stepping-interval">Compute CFL time stepping interval</h2>
<p>Calculate the time stepping interval based on the CFL condition</p>
<pre><code class="language-julia">dt = calculate_dt(n, d, o, v, rho)
</code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li>
<p><code>n</code>: Tuple with number of grid points.</p>
</li>
<li>
<p><code>d</code>: Tuple with grid spacing.</p>
</li>
<li>
<p><code>o</code>: Tuple with coordiante system origin.</p>
</li>
<li>
<p><code>v</code>: 2D/3D Julia array with velocity in <code>[km/s]</code>.</p>
</li>
<li>
<p><code>rho</code>: 2D/3D Julia array with density in <code>[g/cm^3]</code>.</p>
</li>
</ul>
<h2 id="compute-number-of-computational-time-steps">Compute number of computational time steps</h2>
<p>Estimate the number of computational time steps. Required for calculating the dimensions of the matrix-free linear modeling operators:</p>
<pre><code class="language-julia">nt = get_computational_nt(src_geometry, rec_geometry, model)
</code></pre>
<p><strong>or</strong> (for extended source modeling, where <code>src_geometry</code> is not available):</p>
<pre><code class="language-julia">nt = get_computational_nt(rec_geometry, model)
</code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li>
<p><code>src_geometry</code>: A JUDI <code>Geometry</code> object with the source geometry.</p>
</li>
<li>
<p><code>rec_geometry</code>: A JUDI <code>Geometry</code> object with the receiver geometry.</p>
</li>
<li>
<p><code>model</code>: A JUDI <code>Model</code> object containing the velocity model.</p>
</li>
</ul>
<h2 id="set-up-3d-acquisition-grid">Set up 3D acquisition grid</h2>
<p>Helper function to create a regular acquisition grid for a 3D survey.</p>
<pre><code class="language-julia">x_coord_full, y_coord_full, z_coord_full = setup_3D_grid(x_coord, y_coord, z_coord)
</code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li>
<p><code>x_coord</code>: 1D julia vector of length <code>nx</code>, where <code>nx</code> is the number of distinct source/receiver locations in x direction. </p>
</li>
<li>
<p><code>y_coord</code>: 1D julia vector of length <code>ny</code>, where <code>ny</code> is the number of distinct source/receiver locations in y direction. </p>
</li>
<li>
<p><code>z_coord</code>: Single scalar for depth of sources/receivers.</p>
</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>
<p><code>x_coord_full</code>: 1D julia vector of length <code>nx * ny</code> with source/receiver locations in x direction.</p>
</li>
<li>
<p><code>y_coord_full</code>: 1D julia vector of length <code>nx * ny</code> with source/receiver locations in y direction.</p>
</li>
<li>
<p><code>z_coord_full</code>: 1D julia vector of length <code>nx * ny</code> with source/receiver locations in z direction.</p>
</li>
</ul>
<h2 id="data-interpolation">Data interpolation</h2>
<p>Time interpolation for source/receiver data using splines. For modeling, the data is interpolated automatically onto the computational time axis, so generally, these functions are not needed for users.</p>
<pre><code class="language-julia">data_interp, geometry_out = time_resample(data, geometry_in, dt_out; order=2)
</code></pre>
<p><strong>or</strong>:</p>
<pre><code class="language-julia">data_interp = time_resample(data, geometry_out, dt_in; order=2)
</code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li>
<p><code>data</code>: 2D Julia array of source/receiver data.</p>
</li>
<li>
<p><code>geometry_in</code>: A JUDI <code>Geometry</code> object of the input data before interpolation.</p>
</li>
<li>
<p><code>dt_out</code>: Sampling interval of interpolated shot record in milliseconds <code>[ms]</code>.</p>
</li>
<li>
<p><code>order</code>: Order of splines for interpolation. </p>
</li>
</ul>
<p><strong>or:</strong></p>
<ul>
<li>
<p><code>data</code>: 2D Julia array of source/receiver data.</p>
</li>
<li>
<p><code>geometry_out</code>: A JUDI <code>Geometry</code> object of the data after interpolation.</p>
</li>
<li>
<p><code>dt_in</code>: Sampling interval of input shot record in milliseconds <code>[ms]</code>.</p>
</li>
</ul>
<h2 id="generate-and-sample-from-frequency-distribution">Generate and sample from frequency distribution</h2>
<p>Create a probability distribution with the shape of the source spectrum from which we can draw random frequencies.</p>
<pre><code>dist = generate_distribution(q; src_no=1)
</code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li>
<p><code>q</code>: Source vector of type <code>judiVector</code> from which to create the distribution.</p>
</li>
<li>
<p><code>src_no</code>: Source number for which to create the distribution (i.e. <code>q[src_no]</code>).</p>
</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>dist</code>: probability distribution. </li>
</ul>
<p>We can draw random samples from <code>dist</code> by passing it values between 0 and 1:</p>
<pre><code class="language-julia"># Draw a single random frequency
f = dist(rand(1))

# Draw 10 random frequencies
f = dist(rand(10))
</code></pre>
<p>Alternatively, we can use the function:</p>
<pre><code class="language-julia">f = select_frequencies(dist; fmin=0f0, fmax=Inf, nf=1)
</code></pre>
<p>to draw <code>nf</code> number of frequencies for a given distribution <code>dist</code> in the frequency range of <code>fmin</code> to <code>fmax</code> (both in kHz).</p>
<h2 id="read-data-from-out-of-core-container">Read data from out of core container</h2>
<p>In the case where a <code>judiVector</code> is out of core (points to a segy file) it is possible to convert it or part of it into an in core <code>judiVecor</code> with the <code>get_data</code> function.</p>
<pre><code class="language-julia">d_ic = get_data(d_ooc, inds)
</code></pre>
<p>where <code>inds</code> is either a single index, a list of index or a range of index.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../preconditioners/" class="btn btn-neutral float-right" title="Preconditioners">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../io/" class="btn btn-neutral" title="Input/Output"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>Copyright 2020, SLIM @ Georgia Institute of Technology</p>
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/slimgroup/JUDI.jl/" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../io/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../preconditioners/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
